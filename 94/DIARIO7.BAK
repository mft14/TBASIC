2 DIM D$(100,8)
3 COLOR 8,11:Z=0:Y=1:KEY OFF:O=0:S=0
4 GOTO 300
5 GOSUB 5000
6 CLS:H$="":X$=""
10 C$=""
11 ?"                    ----------------------------------------"
12 ?"                     A PROGRAMME BY TOM KIEL JUNE 1989  (C)"
13 ?"                    ----------------------------------------"
30 F=0
60 ?:?"                                  DIARIO (C)
70 ?:?
100?"                                  1 - WRITE"
105?
110?"                                  2 - READ"
120?
130?"                                  3 - END"
140?
145 IF Z=0 THEN PRINT"                               LOADING NO FILE":?:D=0:GOTO 155
150?:?"                                  FILE  "M$+Y$
155?
160 PRINT"                                 PLEASE SELECT "
165 H$=INKEY$:IF H$=""THEN 165
202 IF H$="1" THEN 15000
203 IF H$="2" THEN 25000
204 IF H$="3" THEN 30000
205 H$=""
210 GOTO 6
300 cls:?:?:?:?"             CREATE NEW FILE   Y/N  ?"
310 X$=INKEY$:IF X$="" THEN 310
320 IF X$="Y" OR X$="y" THEN 15000
330 IF X$="N" OR X$="n" THEN 5
5000 CLS:?:?
5004 ?:?"                    ACCESS CODE ? "
5005 E$=INPUT$(3):IF E$=chr$(0)then 5005
5006 IF E$<>"237"THEN CLS:?:?:?:?"                   ACCESS DENIED !":END
5007 CLS:
5010 PRINT
5020 ?:?:?:PRINT"                       PLEASE FILENAME  I.E. JULI 1963 "
5030 ?:?:INPUT"                         PRESS M FOR MENUE";T$
5040 IF T$="M" or T$="m" THEN 6
5050 CLS:X$="":D=1
5062 Y$=RIGHT$(T$,2)
5064 M$=LEFT$(T$,3)
5065 F$=M$+Y$+".DAT"
5066 CH$=Y$+"\"+M$
5067 CHDIR CH$
5070 OPEN F$ FOR INPUT AS #1
5075 INPUT#1,Z
5080    FOR Y=1 TO Z
5082    LOCATE 13,10
5084    PRINT TAB(20)"LOADING FILE "F$"   RECORD NUMBER ";:PRINT USING "##";Y;
5090       FOR I=1 TO 8
5100       LINE INPUT#1,D$(Y,I)
5110       NEXT I
5111    NEXT Y
5120 CLOSE#1
5125 CD$="D:\"
5130 CHDIR CD$
5200 RETURN
10000 CLS
10002 IF D=0 THEN T$=""
10005 IF T$=""THEN 10010
10007 GOTO 10022
10010 ?:?:INPUT"                       PLEASE FILENAME ";T$
10011 IF T$=""THEN CLS:GOTO 10010
10012 Y$=RIGHT$(T$,2)
10013 M$=LEFT$(T$,3)
10016 D=1
10022 F$=M$+Y$+".DAT"
10027 X$=""
10050 ?:?:?"                       SAVING NOW CHANGED DATAFILE"
10053 CH$=Y$+"\"+M$
10054 CHDIR CH$
10060 OPEN F$ FOR OUTPUT AS #1
10070 PRINT#1,Z
10080    FOR Y=1 TO Z
10082    LOCATE 12,10
10084    PRINT TAB(20)"SAVING FILE "F$"   RECORD NUMBER ";:PRINT USING "##";Y;
10090       FOR I=1 TO 8
10100       PRINT#1,D$(Y,I)
10110       NEXT I
10120    NEXT Y
10121 CLOSE#1
10122 CD$="D:\"
10123 CHDIR CD$
10124 PRINT:PRINT"                     PLEASE INSERT DISK  'ORIGINAL DATA' -> "
10125 PRINT:INPUT"                     AND PRESS Y/N IF YOU LIKE TO SAVE ->";FG$
10126 IF FG$="N" OR FG$="n" THEN CLS:GOTO 10144
10127 SHELL "A:"
10128 CH$=Y$+"\"+M$
10129 CHDIR CH$
10130 OPEN F$ FOR OUTPUT AS #1
10131 PRINT#1,Z
10132    FOR Y=1 TO Z
10133    LOCATE 12,10
10134    PRINT TAB(20)"SAVING FILE "F$"   RECORD NUMBER ";:PRINT USING "##";Y;
10135       FOR I=1 TO 8
10136       PRINT#1,D$(Y,I)
10137       NEXT I
10138    NEXT Y
10139 CLOSE#1
10140 CD$="A:\"
10141 CHDIR CD$
10142 SHELL "D:"
10143 REM:CD$="D:\"
10144 PRINT:PRINT:
10145 PRINT:INPUT"                  WOULD YOU LIKE TO SAVE ON DRIVE B  Y/N ";HH$
10147 IF HH$="Y" OR HH$="y" THEN 42000
10150 O=0:X$=""
10160 RETURN
15000 Z=Z+1:Y=Y+1
15010 CLS:?:?"             DATA INPUT            PAGE "Z
15020 O=1
15025 REM
15035    FOR I=1 TO 8
15037       ?:? I;
15040       LINE INPUT D$(Z,I)
15045       IF D$(Z,I)=""THEN D$(Z,I)="---"
15050    NEXT I
15060 ?:?:PRINT"                INPUT RIGHT  Y/N "
15070 X$=INKEY$:IF X$=""THEN 15070
15080 IF X$<>"Y"AND X$<>"N"AND x$<>"y"AND x$<>"n" THEN 15060
15090 IF X$="N"or x$="n"THEN Z=Z-1:Y=Y-1:X$="":O=0:GOTO 6
15095 X$=""
15100 ?:PRINT"                NEXT PAGE    Y/N "
15110 X$=INKEY$:IF X$=""THEN 15110
15120 IF X$<>"Y"AND X$<>"N"AND X$<>"y"AND X$<>"n"THEN 15100
15130 IF X$="Y"OR X$="y"THEN X$="":GOTO 15000
15140 GOTO 6
25000 CLS:ZZ=1:X$=""
25007 IF Z=0 THEN 41000
25010 CLS:?:?TAB(3)"READ AND CHANGE         PAGE"ZZ"OF"Z"          FILE "T$
25020 ?"---------------------------------------------------------------------"
25025 ?:
25040    FOR I=1 TO 8
25050    PRINT I;D$(ZZ,I)
25060    PRINT
25070    NEXT I
25085 ?"---------------------------------------------------------------------"
25090 ?:PRINT"     AHEAD=V        BACK=R        MENU=M        CHANGE=A"
25094 X$=""
25095 X$=INKEY$:IF X$=""THEN 25095
25100 IF X$="V"AND ZZ<Z THEN ZZ=ZZ+1:GOTO 25010
25102 IF X$="v"AND ZZ<Z THEN ZZ=ZZ+1:GOTO 25010
25105 IF X$="V"AND ZZ=Z THEN ZZ=1:GOTO 25010
25107 IF X$="v"AND ZZ=Z THEN ZZ=1:GOTO 25010
25110 IF X$="R"AND ZZ>1 THEN ZZ=ZZ-1:GOTO 25010
25112 IF X$="r"AND ZZ>1 THEN ZZ=ZZ-1:GOTO 25010
25115 IF X$="R"AND ZZ=1 THEN ZZ=Z:GOTO 25010
25117 IF X$="r"AND ZZ=1 THEN ZZ=Z:GOTO 25010
25120 IF X$="M"OR X$="m"THEN 6
25130 IF X$="A"OR X$="a"THEN 25150
25140 GOTO 6
25150 INPUT"   LINE NR.  ";X
25160 IF X<1 OR X>8 THEN 25150
25165 O=1
25170 LINE INPUT"   NEW INPUT ";D$(ZZ,X)
25180 IF D$(ZZ,X)=""THEN D$(ZZ,X)="---"
25190 GOTO 25010
30000 CLS:X$=""
30037 IF O=1 THEN GOSUB 10000
30040 COLOR 7,0:CLS:PRINT:PRINT:PRINT:PRINT
30050 PRINT"   THANK YOU USING THIS FINE PROGRAMME BY TOM KIEL":?:?:?:?:?:?:?:END
41000 CLS:?:?:?"   NO DATA AVAILABLE !"
41010 FOR T=1 TO 10000:NEXT T
41020 GOTO 6
42000 SHELL "B:"
42010 CHDIR CH$
42020 OPEN F$ FOR OUTPUT AS #1
42030 PRINT #1,Z
42040    FOR Y=1 TO Z
42042    LOCATE 12,10
42044    PRINT TAB(20)"SAVING FILE "F$"   RECORD NUMBER ";:PRINT USING "##";Y;
42050       FOR I=1 TO 8
42060       PRINT#1,D$(Y,I)
42070       NEXT I
42080    NEXT Y
42090 CLOSE#1
42095 CHDIR CD$
42100 CHDIR "B:\"
42110 SHELL "D:"
42120 GOTO 10150