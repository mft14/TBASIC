2 DIM D$(710,7)
3 PT$(1)="   DATEI LADEN   "
6 PT$(2)="  DATEN AENDERN  "
8 PT$(3)=" DATEN AUSGEBEN  "
9 PT$(4)="PROGRAMM BEENDEN "
10 F$(1)="TITLE "
11 F$(2)="INT.  "
12 F$(3)="YEAR  "
13 F$(4)="MONTH "
14 F$(5)="WEEKS "
15 F$(6)="H.POS "
16 F$(7)="TAPE  "
17 KEY 1, "V":REM VORWAERTS
18 KEY 2, "R":REM RUECKWAERTS
19 KEY 3, "A":REM AENDERN
20 KEY 8, "M":REM MENUE
22 KEY5,"J"
25 GOTO 1000
100 REM =====================
110 REM    PROGRAMMKOPF
120 REM =====================
130 CLS
140 FOR I=1 TO 40:PRINT"=";:NEXT
150 PRINT"               BFBS GOLD  "
160 FOR I=1 TO 40:PRINT"=";:NEXT
170 PRINT
180 RETURN
200 REM =====================
210 REM FEHLERMELDUNG
220 REM =====================
230 LOCATE 1,24, ?FE$
240 FOR I=1 TO 1000:NEXT
250 LOCATE 1,24,?"                     "
260 RETURN
300 CLS:REM GOSUB 100
330 CLS:GOSUB 100
340 PRINT ,10,1,"*******************"
350 PRINT ,10,2,"*"+PT$(F)+"*"
360 PRINT ,10,3,"*******************"
370 RETURN
500 REM ======================
510 REM DATEN IM RECHNER
520 REM ======================
530 FE$="KEINE DATEN IM RECHNER ! "
535 REM
540 GOSUB 200
550 RETURN
560 REM:NEXT I
1000 GOSUB 100
1001 KEY4,F$
1005 F=0
1010 PRINT"        PROGRAMMFUNKTIONEN:"
1020 PRINT"        -------------------"
1030 PRINT
1040 PRINT"        -1- DATEI LADEN"
1042 PRINT
1070 PRINT"        -2- DATEN AENDERN"
1072 PRINT
1090 PRINT"        -3- DATEN AUSGEBEN"
1091 REMIF Y>0 THEN Y=Y-1
1092 PRINT
1100 PRINT"        -4- PROGRAMM BEENDEN"
1101 PRINT:PRINT"      DATEI "F$" MIT"Y-1"DATEN-"
1102 PRINT:PRINT"        SAETZEN IM RECHNER"
1110 PRINT
1120 INPUT"        AUSWAHL (1-4):";F
1121 IF Y>0 THEN Y=Y+1
1130 IF F=0 OR F>4 THEN FE$="               WAS?": GOSUB 200:GOTO 1000
1140 ON F GOTO 5000,20000,30000,35000
5000 REM ==================
5010 REM   DATEI LADEN
5020 REM ==================
5021 IF Z>0 THEN 5023
5022 GOTO 5030
5024 CLS:PRINT:PRINT:PRINT:PRINT:PRINT"        DATEN IM RECHNER !!!!!"
5025 FOR T=1 TO 2000:NEXT T:GOTO1000
5030 GOSUB 300
5031 F$="BFBS.DAT":GOTO 5066
5040 PRINT:PRINT"          MIT > * < ZURUECK !"
5041 PRINT:PRINT:PRINT"        BITTE DATEINAME EINGEBEN"
5042 REM:PRINT:INPUT"     ";F$
5050 IF F$="*"THEN 1000
5066 CLS:FOR T=1 TO 20:NEXT
5069 LOCATE 9,12,?"DATEN WERDEN GELADEN"
5070 OPEN F$ FOR INPUT AS #1
5080 INPUT#1,Z
5090 FOR Y=1 TO Z
5100 FOR I=1 TO 7
5110 INPUT#1,D$(Y,I)
5120 NEXTI
5130 NEXTY
5140 CLOSE1
5150 PRINT:PRINT:PRINT:PRINT:PRINT:PRINT" DATEI "F$" MIT"Y-1"DATENS. GELADEN"
5151 LOCATE,9,20,"WEITER MIT LEERTASTE"
5152 GETKEY V$:IF V$<>CHR$(32)THEN 5152
5170 GOTO 1000
20000 REM =========================
20010 REM  DATEN  AENDERN
20020 REM =========================
20030 ZZ=1
20040 GOSUB 300
20050 PRINT
20060 IF Z=0 THEN GOSUB 500:GOTO 1000
20070 FOR I=1 TO 7
20080 PRINT I;F$(I);D$(ZZ,I):PRINT
20090 NEXT
20091 PRINT" DATENSATZ"ZZ"VON"Z:
20092 PRINT:PRINT" DATENSATZ X MIT F 5"
20100 X$=INKEY$:IF X$="" THEN 20100
20110 IF X$="M" THEN 1000
20120 IF X$="V" AND ZZ<Z THEN ZZ=ZZ+1:GOTO 20040
20130 IF X$="R" AND ZZ>1THEN ZZ=ZZ-1:GOTO20040
20140 IF X$="A" THEN 20160
20141 IF X$="J"THEN 20143
20142 GOTO 20150
20143 PRINT:PRINT" DATENSATZ? ( 1 -"Z")"
20144 PRINT:INPUT" ";G:IF G<0THEN 20220
20145 IF G>Z THEN 20220
20146 W=G-1
20147 ZZ=1
20148 ZZ=ZZ+W:GOTO 20040
20150 FE$="EINGABEFEHLER!":GOSUB 200:GOTO 20100
20160 PRINT:PRINT
20170 INPUT " FELDNUMMER (1-7) ";X
20180 IF X<1 OR X>7 THEN PRINT CHR$(145);:GOTO 20170
20190 PRINT
20200 INPUT" NEUER INHALT: ";D$(ZZ,X)
20210 GOTO 20040
20220 CLS:PRINT:PRINT:PRINT:PRINT:PRINT"    KOENNEN SIE NICHT RICHTIG LESEN?"
20221 PRINT:PRINT:PRINT"        DATENSATZ"ZZ"VON"Z"?"
20222 PRINT:PRINT"     UND SIE GEBEN"G"EIN WAS?"
20223 FOR T=1 TO 5000:NEXT T:GOTO 20000
30000 REM ========================
30010 REM   DATEN  AUSGEBEN
30020 REM ========================
30030 REMGOSUB 300
30040 IF Z=0 THEN GOSUB 500:GOTO 1000
30050 REMPRINT" DRUCKER ODER BILDSCHIRM? ‚D/B„"
30052 REMGETKEY G$:IF G$<>"B"AND G$<>"D"THEN 30052
30053 G$="B"
30060 IF G$="D" THEN OPEN 1,4
30070 GOSUB 300:PRINT:PRINT
30080 PRINT"SUCHBEGRIFFE:"
30090 PRINT"-------------"
30100 PRINT
30110 FOR I=1 TO 7
30120 S$(I)=" "
30130 PRINT F$(I);
30140 INPUT S$(I):PRINT
30150 NEXT
30151 CHAR0,7,23,"RICHTIG EINGEGEBEN?  J/N "
30152 GETKEY V$:IF V$<>"J"AND V$<>"N"THEN 30155
30153 IF V$="N"THEN 30000
30154 IF V$="J"THEN 30156
30155 GOTO 30152
30156 LOCATE ,5,23,"     ‚DATEN WERDEN GESUCHT„"
30159 SOUND 1,800,5
30160 FOR Y=1 TO Z
30170 S=0
30180 FOR I=1 TO 7
30190 IF S$(I)=" " OR S$(I)=D$(Y,I) THEN S=S+1
30200 NEXT I
30210 IF S<>7 THEN 30290
30220 IF G$="D" THEN PRINT#1
30230 IF G$="B" THEN GOSUB 300:PRINT
30240 FOR I=1 TO 7
30250 IFG$="B"THENPRINT F$(I);D$(Y,I):PRINT
30260 IFG$="D"THENPRINT#1,F$(I);D$(Y,I)
30270 NEXT I
30275 PRINT:PRINT"DATENSATZ"Y"VON"Z:
30276 PRINT:PRINT"SPACE=WEITER  E=ENDE"
30280 GETKEY X$:IF X$<>CHR$(32)AND X$<>"E"THEN 30285
30281 SOUND 1,800,5
30282 IF X$="E"THEN Y=Z:GOTO 30300
30283 IF X$=CHR$(32)THEN 30284
30284 PRINT:PRINT"         ‚DATEN WERDEN GESUCHT„":GOTO30290
30285 SOUND1,600,25:GOTO 30280
30290 NEXT Y
30300 GOSUB 300:PRINT
30310 SOUND1,800,30:PRINT"           ** DATEIENDE **"
30315 FOR T=1 TO 1000:NEXT
30320 REM PRINT:INPUT"DRUECKEN SIE RETURN";X$
30330 IFG$="D"THEN CLOSE 1
30331 PRINT:PRINT:PRINT:PRINT:PRINT
30332 PRINT"WOLLEN SIE WEITER NACH DATEN SUCHEN? ‚J/N„"
30333 GETKEY V$:IF V$<>"J"AND V$<>"N"THEN 30333
30334 IF V$="J"THEN 30070
30335 IF V$="N"THEN 1000
35000 REM =======================
35010 REM  PROGRAMM BEENDEN
35020 REM =======================
35030 GOSUB 300:PRINT:PRINT
35040 IF Z=0 THEN 35150
35050 PRINT"SIND ALLE DATEN GESICHERT? J/N"
35060 GETKEY X$:IF X$<>"J"AND X$<>"N"THEN 35060
35070 IF X$="N"THEN 1000
35080 IF X$="J" THEN 35100
35090 CLS;:GOTO 35050
35100 GOSUB 300:PRINT:PRINT
35110 PRINT"DAS PROGRAMM KANN MIT 'GOTO 3' WIEDER";
35120 PRINT"GESTARTET WERDEN, OHNE DASS DATEN VER-"
35130 PRINT"LOREN GEHEN!"
35140 PRINT:PRINT
35180 END