2 DIM D$(100,8):color 0,7
4 Z=0:Y=1:KEY OFF:O=0:S=0:CLS:GOTO 10
6 CLS:H$="":X$="":IF DR$="" THEN DR$="A"
7 REM:CD$=DR$+":\"
8 REM:CHDIR CD$
9 REM
10 C$=""
11 ?tab(20)"----------------------------------------"
12 ?tab(20)" A PROGRAMME BY TOM KIEL APRIL 1992  (C)"
13 ?tab(20)"----------------------------------------"
20 KEY OFF
30 F=0
60 ?:?tab(20)"            DIARIUNI (C)
70 ?:?
80 ?tab(20)"              1 - LOAD"
85 ?
90 ?tab(20)"              2 - SAVE"
95 ?
100?tab(20)"              3 - WRITE"
105?
110?tab(20)"              4 - CHANGE"
120?
130?tab(20)"              5 - END"
140?
145 IF Z=0 THEN PRINT tab(20)"            LOADING NO FILE":?:D=0:GOTO 155
150?:?tab(20)"             FILE  "T$
155?
160 PRINT tab(20);"             PLEASE SELECT "
165 H$=INKEY$:IF H$=""THEN 165
200 IF H$="1" THEN 5000
201 IF H$="2" THEN 10000
202 IF H$="3" THEN 15000
203 IF H$="4" THEN 25000
204 IF H$="5" THEN 30000
205 H$=""
210 GOTO 6
5000 CLS:?:?
5004 ?:?tab(20)"   ACCESS CODE ? ":PRINT
5005 color 7,7:INPUT" ";E$
5006 IF E$<>"237"THEN CLS:COLOR 0,7:?:?:?:?tab(20)"   ACCESS DENIED !":END
5007 CLS:COLOR 0,7
5010 PRINT
5020 DV$="A:"
5030 REM:(20):INPUT"   DRIVE A TO E ";DR$
5035 ?:?tab(20):INPUT"   WHICH YEAR ";Y$
5040 ?:?tab(20):INPUT"   WHICH MONTH";M$
5041 CLS:X$="":D=1
5042 DV$=DR$+":"
5043 SHELL DV$
5044 CH$=Y$+"\"+M$
5045 CHDIR CH$
5048 SHELL "DIR/P":
5049 LOCATE 24,3:INPUT" PLEASE FILENAME  ";T$
5050 X$="":D=1
5055 LOCATE 24,3:?
5065 F$=T$+".DAT":LOCATE 22,3:?"   PATH: "DV$+"\"+Y$+"\"+M$" FILE: "F$
5066 ?:?TAB(20):INPUT"   O.K. Y/N ";OK$:IF OK$="N" OR OK$="n"THEN 6
5070 OPEN F$ FOR INPUT AS #1
5075 INPUT#1,Z
5080    FOR Y=1 TO Z
5090       FOR I=1 TO 8
5100       INPUT#1,D$(Y,I)
5110       NEXT I
5111    NEXT Y
5120 CLOSE#1
5122 CD$="D:\"
5130 CHDIR CD$
5140 REM:SHELL "D:"
5200 GOTO 6
10000 CLS
10001 IF Z=0 THEN GOTO 41000
10002 IF D=0 THEN T$=""
10005 IF T$=""THEN 10010
10007 GOTO 10022
10010 ?:INPUT"   PLEASE FILENAME ";T$
10011 IF T$=""THEN CLS:GOTO 10010
10012 Y$=RIGHT$(T$,2)
10013 M$=LEFT$(T$,3)
10016 D=1
10022 F$=M$+Y$+".DAT"
10025 ?:?TAB(20)"   LOADING DATEI "T$
10027 X$=""
10030 ?:PRINT TAB(20)"   ERASING FILE Y/N "
10035 X$=INKEY$:IF X$=""THEN 10035
10040 IF X$<>"Y"AND X$<>"N"AND X$<>"y"AND X$<>"n"THEN 10027
10041 IF X$="N" OR X$="n"THEN 6
10042 ?:?TAB(20):INPUT"   DRIVE  A TO E";DR$
10043 ?:?TAB(20):INPUT"   WHICH YEAR   ";Y$
10044 ?:?TAB(20):INPUT"   WHICH MONTH  ";M$
10046 DV$=DR$+":"
10047 SHELL DV$
10053 CH$=Y$+"\"+M$
10054 CHDIR CH$
10055 SHELL "DIR/P":LOCATE 24,2:INPUT"   O.K.  Y/N ";OK$
10056 IF OK$="N" OR OK$="n"THEN 6
10057 F$=T$+".DAT":CLS
10058 ?:? tab(20)"   SAVING NOW "F$"    PATH "DV$+"\"+Y$+"\"+M$
10060 OPEN F$ FOR OUTPUT AS #1
10070 PRINT#1,Z
10080    FOR Y=1 TO Z
10090       FOR I=1 TO 8
10100       PRINT#1,D$(Y,I)
10110       NEXT I
10120    NEXT Y
10123 CLOSE#1
10124 CD$="D:\"
10125 CHDIR CD$
10129 REM:SHELL "D:"
10146 X$=""
10147 ?:?:PRINT TAB(20)"   READY SAVING "T$" PRESS W"
10148 X$=INKEY$:IF X$=""THEN 10148
10149 IF X$<>"W"AND X$<>"w"THEN 10146
10150 O=0:X$="":GOTO 6
15000 Z=Z+1:Y=Y+1
15010 CLS:?:?TAB(20)"   DATA INPUT    PAGE "Z
15020 O=1
15025 REM
15035    FOR I=1 TO 8
15037       ?:? I;
15040       INPUT D$(Z,I)
15045       IF D$(Z,I)=""THEN D$(Z,I)="---"
15050    NEXT I
15060 ?:?:PRINT TAB(20)"    INPUT RIGHT  Y/N "
15070 X$=INKEY$:IF X$=""THEN 15070
15080 IF X$<>"Y"AND X$<>"N"AND x$<>"y"AND x$<>"n" THEN 15060
15090 IF X$="N"or x$="n"THEN Z=Z-1:Y=Y-1:X$="":CLS:GOTO 6
15095 X$=""
15100 ?:PRINT TAB(20)"    NEXT PAGE    Y/N "
15110 X$=INKEY$:IF X$=""THEN 15110
15120 IF X$<>"Y"AND X$<>"N"AND X$<>"y"AND X$<>"n" THEN 15100
15130 IF X$="Y"OR X$="y"THEN X$="":GOTO 15000
15140 GOTO 6
25000 CLS:ZZ=1:X$=""
25005 KEY 1,"V":KEY 2,"R":KEY 3,"A":KEY 4,"M"
25007 IF Z=0 THEN 41000
25010 CLS:?:?TAB(3)"READ AND CHANGE          PAGE"ZZ"OF"Z"           FILE "T$
25020 ?"---------------------------------------------------------------------"
25025 ?:
25040    FOR I=1 TO 8
25050    PRINT I;D$(ZZ,I)
25060    PRINT
25070    NEXT I
25085 ?"---------------------------------------------------------------------"
25090 ?:PRINT"       AHEAD=V          BACK=R          MENU=M          CHANGE=A"
25094 X$=""
25095 X$=INKEY$:IF X$=""THEN 25095
25100 IF X$="V"AND ZZ<Z THEN ZZ=ZZ+1:GOTO 25010
25102 IF X$="v"AND ZZ<Z THEN ZZ=ZZ+1:GOTO 25010
25105 IF X$="V"AND ZZ=Z THEN ZZ=1:GOTO 25010
25107 IF X$="v"AND ZZ=Z THEN ZZ=1:GOTO 25010
25110 IF X$="R"AND ZZ>1 THEN ZZ=ZZ-1:GOTO 25010
25112 IF X$="r"AND ZZ>1 THEN ZZ=ZZ-1:GOTO 25010
25115 IF X$="R"AND ZZ=1 THEN ZZ=Z:GOTO 25010
25117 IF X$="r"AND ZZ=1 THEN ZZ=Z:GOTO 25010
25120 IF X$="M"OR X$="m"THEN KEY OFF:GOTO 6
25130 IF X$="A"OR X$="a"THEN 25150
25140 GOTO 25000
25150 INPUT"   LINE NR.  ";X
25160 IF X<1 OR X>8 THEN 25150
25165 O=1
25170 INPUT"   NEW INPUT ";D$(ZZ,X)
25180 IF D$(ZZ,X)=""THEN D$(ZZ,X)="---"
25190 GOTO 25010
30000 CLS:X$=""
30010 ?:?:PRINT tab(20)"   ALL DATA SAVED ?  Y/N "
30015 X$=INKEY$:IF X$=""THEN 30015
30020 IF X$<>"Y"AND X$<>"N"AND X$<>"y"AND X$<>"n"THEN 30000
30030 IF S=3 THEN 30040
30035 IF X$="N"OR X$="n"THEN X$="":GOTO 6
30037 IF O=1 THEN PRINT:PRINT TAB(20)"   DATA NOT YET SAVED":GOTO 30039
30038 GOTO 30040
30039 FOR T=1 TO 9000:NEXT T:S=S+1:GOTO 6
30040 REM:CLS:color 7,0:END
30045 CH$="d:\"
30050 CHDIR CH$
30055 color 7,0:END
41000 CLS:?:?:?TAB(20)"   NO DATA AVAILABLE !"
41010 FOR T=1 TO 10000:NEXT T
41020 GOTO 6
