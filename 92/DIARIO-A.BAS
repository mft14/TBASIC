2 DIM D$(100,8)
4 Z=0:Y=1:KEY OFF:O=0:S=0
6 CLS:H$="":X$=""
10 C$=""
11 ?"----------------------------------------"
12 ?" A PROGRAMME BY TOM KIEL JUNE 1989  (C)"
13 ?"----------------------------------------"
30 F=0
60 ?:?"              DIARIO (C)
70 ?:?
80 ?"              1 - LOAD"
85 ?
90 ?"              2 - SAVE"
95 ?
100?"              3 - WRITE"
105?
110?"              4 - CHANGE"
120?
130?"              5 - END"
140?
145 IF Z=0 THEN PRINT"            LOADING NO FILE":?:D=0:GOTO 155
150?:?"              FILE  "M$+Y$
155?
160 PRINT"             PLEASE SELECT "
165 H$=INKEY$:IF H$=""THEN 165
200 IF H$="1" THEN 5000
201 IF H$="2" THEN 10000
202 IF H$="3" THEN 15000
203 IF H$="4" THEN 25000
204 IF H$="5" THEN 30000
205 H$=""
210 GOTO 6
5000 CLS:?:?
5004 ?:?"   ACCESS CODE ? ":PRINT
5005 color 0.7:INPUT" ";E$
5006 IF E$<>"237"THEN CLS:COLOR 7.0:?:?:?:?"   ACCESS DENIED !":END
5007 CLS:COLOR 7.0
5010 PRINT
5020 ?:?:?:INPUT"   PLEASE FILENAME  I.E. JULI 1963 ";T$
5050 CLS:X$="":D=1
5062 Y$=RIGHT$(T$,2)
5064 M$=LEFT$(T$,3)
5065 F$=M$+Y$+".DAT"
5066 CH$=Y$+"\"+M$
5067 CHDIR CH$
5070 OPEN F$ FOR INPUT AS #1
5075 INPUT#1,Z
5080    FOR Y=1 TO Z
5090       FOR I=1 TO 8
5100       INPUT#1,D$(Y,I)
5110       NEXT I
5111    NEXT Y
5120 CLOSE#1
5125 CD$="A:\"
5130 CHDIR CD$
5200 GOTO 6
10000 CLS
10001 IF Z=0 THEN GOTO 41000
10002 IF D=0 THEN T$=""
10005 IF T$=""THEN 10010
10007 GOTO 10022
10010 ?:?:INPUT"   PLEASE FILENAME ";T$
10011 IF T$=""THEN CLS:GOTO 10010
10012 Y$=RIGHT$(T$,2)
10013 M$=LEFT$(T$,3)
10016 D=1
10022 F$=M$+Y$+".DAT"
10025 ?:?"   LOADING DATEI "M$+Y$
10027 X$=""
10030 ?:?:PRINT"   ERASING FILE Y/N "
10035 X$=INKEY$:IF X$=""THEN 10035
10040 IF X$<>"Y"AND X$<>"N"AND X$<>"y"AND X$<>"n"THEN 10027
10050 IF X$="N"THEN 6
10052 IF X$="n"THEN 6
10053 CH$=Y$+"\"+M$
10054 CHDIR CH$
10060 OPEN F$ FOR OUTPUT AS #1
10070 PRINT#1,Z
10080    FOR Y=1 TO Z
10090       FOR I=1 TO 8
10100       PRINT#1,D$(Y,I)
10110       NEXT I
10120    NEXT Y
10123 CLOSE#1
10124 CD$="A:\"
10125 CHDIR CD$
10146 CLS:X$=""
10147 ?:?:PRINT"   READY SAVING "M$+Y$" PRESS W"
10148 X$=INKEY$:IF X$=""THEN 10148
10149 IF X$<>"W"AND X$<>"w"THEN 10146
10150 O=0:X$="":GOTO 6
15000 Z=Z+1:Y=Y+1
15010 CLS:?:?"   DATA INPUT    PAGE "Z
15020 O=1
15025 REM
15035    FOR I=1 TO 8
15037       ?:? I;
15040       INPUT D$(Z,I)
15045       IF D$(Z,I)=""THEN D$(Z,I)="---"
15050    NEXT I
15060 ?:?:PRINT"    INPUT RIGHT  Y/N "
15070 X$=INKEY$:IF X$=""THEN 15070
15080 IF X$<>"Y"AND X$<>"N"AND x$<>"y"AND x$<>"n" THEN 15060
15090 IF X$="N"or x$="n"THEN Z=Z-1:Y=Y-1:X$="":GOTO 6
15095 X$=""
15100 ?:PRINT"    NEXT PAGE    Y/N "
15110 X$=INKEY$:IF X$=""THEN 15110
15120 IF X$<>"Y"AND X$<>"N"AND X$<>"y"AND X$<>"n"THEN 15100
15130 IF X$="Y"OR X$="y"THEN X$="":GOTO 15000
15140 GOTO 6
25000 CLS:ZZ=1:X$=""
25007 IF Z=0 THEN 41000
25010 CLS:?:?TAB(3)"READ AND CHANGE    PAGE"ZZ"OF"Z"     FILE "T$
25020 ?"-----------------------------------------------------"
25025 ?:
25040    FOR I=1 TO 8
25050    PRINT I;D$(ZZ,I)
25060    PRINT
25070    NEXT I
25085 ?"-----------------------------------------------------"
25090 ?:PRINT"   AHEAD=V      BACK=R      MENU=M      CHANGE=A"
25094 X$=""
25095 X$=INKEY$:IF X$=""THEN 25095
25100 IF X$="V"AND ZZ<Z THEN ZZ=ZZ+1:GOTO 25010
25102 IF X$="v"AND ZZ<Z THEN ZZ=ZZ+1:GOTO 25010
25105 IF X$="V"AND ZZ=Z THEN ZZ=1:GOTO 25010
25107 IF X$="v"AND ZZ=Z THEN ZZ=1:GOTO 25010
25110 IF X$="R"AND ZZ>1 THEN ZZ=ZZ-1:GOTO 25010
25112 IF X$="r"AND ZZ>1 THEN ZZ=ZZ-1:GOTO 25010
25115 IF X$="R"AND ZZ=1 THEN ZZ=Z:GOTO 25010
25117 IF X$="r"AND ZZ=1 THEN ZZ=Z:GOTO 25010
25120 IF X$="M"OR X$="m"THEN 6
25130 IF X$="A"OR X$="a"THEN 25150
25140 GOTO 6
25150 INPUT"   LINE NR.  ";X
25160 IF X<1 OR X>8 THEN 25150
25165 O=1
25170 INPUT"   NEW INPUT ";D$(ZZ,X)
25180 IF D$(ZZ,X)=""THEN D$(ZZ,X)="---"
25190 GOTO 25010
30000 CLS:X$=""
30010 ?:?:PRINT"   ALL DATA SAVED ?  Y/N "
30015 X$=INKEY$:IF X$=""THEN 30015
30020 IF X$<>"Y"AND X$<>"N"AND X$<>"y"AND X$<>"n"THEN 30000
30030 IF S=3 THEN 30040
30035 IF X$="N"OR X$="n"THEN X$="":GOTO 6
30037 IF O=1 THEN PRINT:PRINT"   DATA NOT YET SAVED":GOTO 6
30038 GOTO 30040
30039 FOR T=1 TO 4000:NEXT T:S=S+1:GOTO 30000
30040 CLS:END
41000 CLS:?:?:?"   NO DATA AVAILABLE !"
41010 FOR T=1 TO 10000:NEXT T
41020 GOTO 6
